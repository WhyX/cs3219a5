<!DOCTYPE html>
<html lang="en">
<head>
  <title>{{seo.commithistory.title}}</title>
  <meta charset="utf-8">
  <meta name="description" content="{{seo.services.description}}">
  <link href="assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/css/style.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/css/commitHistory.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="assets/js/commitHistory.js"></script>
  <script src="assets/js/jquery.color-2.1.2.min.js"></script>

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.js"></script>
      <![endif]-->
    </head>

    <body class="{{seo.services.body_class}}">

      <div class="container">

        {{> head }}

        <div class="placeholder">
          {{> commithistory }}
        </div>


          <script>
          var url = 'https://api.github.com/repos/';
          var owner = 'tungnk1993/';
          var repo = 'scrapy/';
          var author = 'redapple';
          var prefix = 'commits?per_page=100&author='.concat(author);
          var url = url.concat(owner).concat(repo).concat(prefix);
          var commits = [];

          $.get(url, function(data, status) {
            var processedData = preProcess(data);

            createCommitHistoryTable(processedData);
          });

          var preProcess = function(data) {
            console.log(data);
            var processedData = {};

            for(var i = data.length - 1; i >= 0; i--) {
              var dateTime = data[i].commit.committer.date;
              dateTime = dateTime.substring(0, dateTime.length - 1).split("T");
              var date = dateTime[0];
              var time = dateTime[1];
              var message = data[i].commit.message;
              var image_url = data[i].author.avatar_url;

              var commit = {};
              commit["time"] = time;
              commit["message"] = message;
              commit["image_url"] = image_url;

              if(processedData[date] != null) {
                processedData[date].push(commit);
              } else {
                var newDate = [commit];
                processedData[date] = newDate;
              }
            }

            return processedData;
          }
          </script>

      </body>
      </html>
